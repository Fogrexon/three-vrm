/*! (c) 2020-2021 pixiv Inc. - https://github.com/pixiv/three-vrm/blob/release/LICENSE */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE_VRM_CORE={},e.THREE)}(this,(function(e,t){"use strict";function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var r=i(t);class n extends r.Object3D{constructor(e){super(),this.weight=0,this.isBinary=!1,this.overrideBlink="none",this.overrideLookAt="none",this.overrideMouth="none",this._binds=[],this.name=`VRMExpression_${e}`,this.expressionName=e,this.type="VRMExpression",this.visible=!1}get overrideBlinkAmount(){return"block"===this.overrideBlink?0<this.weight?1:0:"blend"===this.overrideBlink?this.weight:0}get overrideLookAtAmount(){return"block"===this.overrideLookAt?0<this.weight?1:0:"blend"===this.overrideLookAt?this.weight:0}get overrideMouthAmount(){return"block"===this.overrideMouth?0<this.weight?1:0:"blend"===this.overrideMouth?this.weight:0}addBind(e){this._binds.push(e)}applyWeight(e){var t;let i=this.isBinary?0===this.weight?0:1:this.weight;i*=null!==(t=null==e?void 0:e.multiplier)&&void 0!==t?t:1,this._binds.forEach((e=>e.applyWeight(i)))}clearAppliedWeight(){this._binds.forEach((e=>e.clearAppliedWeight()))}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function o(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))}function s(e,t,i){const r=e.parser.json.nodes[t].mesh;if(null==r)return null;const n=e.parser.json.meshes[r],o=[];if(i.isMesh)o.push(i);else{const e=n.primitives.length;for(let t=0;t<e;t++)o.push(i.children[t])}return o}function a(e,t){return o(this,void 0,void 0,(function*(){const i=yield e.parser.getDependency("node",t);return s(e,t,i)}))}function l(e){return o(this,void 0,void 0,(function*(){const t=yield e.parser.getDependencies("node"),i=new Map;return t.forEach(((t,r)=>{const n=s(e,r,t);null!=n&&i.set(r,n)})),i}))}function h(e,t){var i,n;let o=null;if(parseInt(r.REVISION,10)>=133)o=null!==(n=null===(i=e.associations.get(t))||void 0===i?void 0:i.materials)&&void 0!==n?n:null;else{const i=e.associations.get(t);"materials"===(null==i?void 0:i.type)&&(o=i.index)}return o}const u={Aa:"aa",Ih:"ih",Ou:"ou",Ee:"ee",Oh:"oh",Blink:"blink",Happy:"happy",Angry:"angry",Sad:"sad",Relaxed:"relaxed",LookUp:"lookUp",Surprised:"surprised",LookDown:"lookDown",LookLeft:"lookLeft",LookRight:"lookRight",BlinkLeft:"blinkLeft",BlinkRight:"blinkRight",Neutral:"neutral"};function d(e){return Math.max(Math.min(e,1),0)}class p{constructor(){this.blinkExpressionNames=["blink","blinkLeft","blinkRight"],this.lookAtExpressionNames=["lookLeft","lookRight","lookUp","lookDown"],this.mouthExpressionNames=["aa","ee","ih","oh","ou"],this._expressions=[],this._expressionMap={}}get expressions(){return this._expressions.concat()}get expressionMap(){return Object.assign({},this._expressionMap)}get presetExpressionMap(){const e={},t=new Set(Object.values(u));return Object.entries(this._expressionMap).forEach((([i,r])=>{t.has(i)&&(e[i]=r)})),e}get customExpressionMap(){const e={},t=new Set(Object.values(u));return Object.entries(this._expressionMap).forEach((([i,r])=>{t.has(i)||(e[i]=r)})),e}copy(e){return this._expressions.concat().forEach((e=>{this.unregisterExpression(e)})),e._expressions.forEach((e=>{this.registerExpression(e)})),this.blinkExpressionNames=e.blinkExpressionNames.concat(),this.lookAtExpressionNames=e.lookAtExpressionNames.concat(),this.mouthExpressionNames=e.mouthExpressionNames.concat(),this}clone(){return(new p).copy(this)}getExpression(e){var t;return null!==(t=this._expressionMap[e])&&void 0!==t?t:null}registerExpression(e){this._expressions.push(e),this._expressionMap[e.expressionName]=e}unregisterExpression(e){const t=this._expressions.indexOf(e);-1===t&&console.warn("VRMExpressionManager: The specified expressions is not registered"),this._expressions.splice(t,1),delete this._expressionMap[e.expressionName]}getValue(e){var t;const i=this.getExpression(e);return null!==(t=null==i?void 0:i.weight)&&void 0!==t?t:null}setValue(e,t){const i=this.getExpression(e);i&&(i.weight=d(t))}getExpressionTrackName(e){const t=this.getExpression(e);return t?`${t.name}.weight`:null}update(){const e=this._calculateWeightMultipliers();this._expressions.forEach((e=>{e.clearAppliedWeight()})),this._expressions.forEach((t=>{let i=1;const r=t.expressionName;-1!==this.blinkExpressionNames.indexOf(r)&&(i*=e.blink),-1!==this.lookAtExpressionNames.indexOf(r)&&(i*=e.lookAt),-1!==this.mouthExpressionNames.indexOf(r)&&(i*=e.mouth),t.applyWeight({multiplier:i})}))}_calculateWeightMultipliers(){let e=1,t=1,i=1;return this._expressions.forEach((r=>{e-=r.overrideBlinkAmount,t-=r.overrideLookAtAmount,i-=r.overrideMouthAmount})),e=Math.max(0,e),t=Math.max(0,t),i=Math.max(0,i),{blink:e,lookAt:t,mouth:i}}}const c=new r.Color;class m{constructor({material:e,type:t,targetValue:i}){var r,n,o;this.material=e,this.type=t,this.targetValue=i;const s=null===(r=Object.entries(m._propertyNameMapMap).find((([t])=>!0===e[t])))||void 0===r?void 0:r[1],a=null!==(n=null==s?void 0:s[t])&&void 0!==n?n:null;if(null==a)console.warn(`Tried to add a material color bind to the material ${null!==(o=e.name)&&void 0!==o?o:"(no name)"}, the type ${t} but the material or the type is not supported.`),this._state=null;else{const t=e[a].clone(),i=this.targetValue.clone().sub(t);this._state={propertyName:a,initialValue:t,deltaValue:i}}}applyWeight(e){if(null==this._state)return;const{propertyName:t,deltaValue:i}=this._state,r=this.material[t];void 0!==r&&(r.add(c.copy(i).multiplyScalar(e)),"boolean"==typeof this.material.shouldApplyUniforms&&(this.material.shouldApplyUniforms=!0))}clearAppliedWeight(){if(null==this._state)return;const{propertyName:e,initialValue:t}=this._state,i=this.material[e];void 0!==i&&(i.copy(t),"boolean"==typeof this.material.shouldApplyUniforms&&(this.material.shouldApplyUniforms=!0))}}m._propertyNameMapMap={isMeshStandardMaterial:{color:"color",emissionColor:"emissive"},isMeshBasicMaterial:{color:"color"},isMToonMaterial:{color:"color",emissionColor:"emissive",outlineColor:"outlineFactor",rimColor:"rimFactor",shadeColor:"shadeFactor"}};class f{constructor({primitives:e,index:t,weight:i}){this.primitives=e,this.index=t,this.weight=i}applyWeight(e){this.primitives.forEach((t=>{var i;null!=(null===(i=t.morphTargetInfluences)||void 0===i?void 0:i[this.index])&&(t.morphTargetInfluences[this.index]+=this.weight*e)}))}clearAppliedWeight(){this.primitives.forEach((e=>{var t;null!=(null===(t=e.morphTargetInfluences)||void 0===t?void 0:t[this.index])&&(e.morphTargetInfluences[this.index]=0)}))}}const g=new r.Vector2;class v{constructor({material:e,scale:t,offset:i}){var r,n;this.material=e,this.scale=t,this.offset=i;const o=null===(r=Object.entries(v._propertyNamesMap).find((([t])=>!0===e[t])))||void 0===r?void 0:r[1];null==o?(console.warn(`Tried to add a texture transform bind to the material ${null!==(n=e.name)&&void 0!==n?n:"(no name)"} but the material is not supported.`),this._properties=[]):(this._properties=[],o.forEach((r=>{var n;const o=null===(n=e[r])||void 0===n?void 0:n.clone();if(!o)return null;e[r]=o;const s=o.offset.clone(),a=o.repeat.clone(),l=i.clone().sub(s),h=t.clone().sub(a);this._properties.push({name:r,initialOffset:s,deltaOffset:l,initialScale:a,deltaScale:h})})))}applyWeight(e){this._properties.forEach((t=>{const i=this.material[t.name];void 0!==i&&(i.offset.add(g.copy(t.deltaOffset).multiplyScalar(e)),i.repeat.add(g.copy(t.deltaScale).multiplyScalar(e)),i.needsUpdate=!0)}))}clearAppliedWeight(){this._properties.forEach((e=>{const t=this.material[e.name];void 0!==t&&(t.offset.copy(e.initialOffset),t.repeat.copy(e.initialScale),t.needsUpdate=!0)}))}}v._propertyNamesMap={isMeshStandardMaterial:["map","emissiveMap","bumpMap","normalMap","displacementMap","roughnessMap","metalnessMap","alphaMap"],isMeshBasicMaterial:["map","specularMap","alphaMap"],isMToonMaterial:["map","normalMap","emissiveMap","shadeMultiplyTexture","rimMultiplyTexture","outlineWidthMultiplyTexture","uvAnimationMaskTexture"]};class y{constructor(e){this.parser=e}get name(){return"VRMExpressionLoaderPlugin"}afterRoot(e){return o(this,void 0,void 0,(function*(){e.userData.vrmExpressionManager=yield this._import(e)}))}_import(e){return o(this,void 0,void 0,(function*(){const t=yield this._v1Import(e);if(t)return t;const i=yield this._v0Import(e);return i||null}))}_v1Import(e){var t,i;return o(this,void 0,void 0,(function*(){if(!(-1!==(null===(t=this.parser.json.extensionsUsed)||void 0===t?void 0:t.indexOf("VRMC_vrm"))))return null;const s=null===(i=this.parser.json.extensions)||void 0===i?void 0:i.VRMC_vrm;if(!s)return null;if("1.0-beta"!==s.specVersion)return null;const l=s.expressions;if(!l)return null;const d=new Set(Object.values(u)),c=new Map;null!=l.preset&&Object.entries(l.preset).forEach((([e,t])=>{null!=t&&(d.has(e)?c.set(e,t):console.warn(`VRMExpressionLoaderPlugin: Unknown preset name "${e}" detected. Ignoring the expression`))})),null!=l.custom&&Object.entries(l.custom).forEach((([e,t])=>{d.has(e)?console.warn(`VRMExpressionLoaderPlugin: Custom expression cannot have preset name "${e}". Ignoring the expression`):c.set(e,t)}));const g=new p;return yield Promise.all(Array.from(c.entries()).map((([t,i])=>o(this,void 0,void 0,(function*(){var s,l,u,d,p,c,y;const x=new n(t);if(e.scene.add(x),x.isBinary=null!==(s=i.isBinary)&&void 0!==s&&s,x.overrideBlink=null!==(l=i.overrideBlink)&&void 0!==l?l:"none",x.overrideLookAt=null!==(u=i.overrideLookAt)&&void 0!==u?u:"none",x.overrideMouth=null!==(d=i.overrideMouth)&&void 0!==d?d:"none",null===(p=i.morphTargetBinds)||void 0===p||p.forEach((t=>o(this,void 0,void 0,(function*(){var r;if(void 0===t.node||void 0===t.index)return;const n=yield a(e,t.node),o=t.index;n.every((e=>Array.isArray(e.morphTargetInfluences)&&o<e.morphTargetInfluences.length))?x.addBind(new f({primitives:n,index:o,weight:null!==(r=t.weight)&&void 0!==r?r:1})):console.warn(`VRMExpressionLoaderPlugin: ${i.name} attempts to index morph #${o} but not found.`)})))),i.materialColorBinds||i.textureTransformBinds){const t=[];e.scene.traverse((e=>{const i=e.material;i&&t.push(i)})),null===(c=i.materialColorBinds)||void 0===c||c.forEach((e=>o(this,void 0,void 0,(function*(){t.filter((t=>{const i=h(this.parser,t);return e.material===i})).forEach((t=>{x.addBind(new m({material:t,type:e.type,targetValue:(new r.Color).fromArray(e.targetValue)}))}))})))),null===(y=i.textureTransformBinds)||void 0===y||y.forEach((e=>o(this,void 0,void 0,(function*(){t.filter((t=>{const i=h(this.parser,t);return e.material===i})).forEach((t=>{var i,n;x.addBind(new v({material:t,offset:(new r.Vector2).fromArray(null!==(i=e.offset)&&void 0!==i?i:[0,0]),scale:(new r.Vector2).fromArray(null!==(n=e.scale)&&void 0!==n?n:[1,1])}))}))}))))}g.registerExpression(x)}))))),g}))}_v0Import(e){var t;return o(this,void 0,void 0,(function*(){const i=null===(t=this.parser.json.extensions)||void 0===t?void 0:t.VRM;if(!i)return null;const r=i.blendShapeMaster;if(!r)return null;const s=new p,l=r.blendShapeGroups;if(!l)return s;const h=new Set;return yield Promise.all(l.map((t=>o(this,void 0,void 0,(function*(){var i;const r=t.presetName,l=null!=r&&y.v0v1PresetNameMap[r]||null,u=null!=l?l:t.name;if(null==u)return void console.warn("VRMExpressionLoaderPlugin: One of custom expressions has no name. Ignoring the expression");if(h.has(u))return void console.warn(`VRMExpressionLoaderPlugin: An expression preset ${r} has duplicated entries. Ignoring the expression`);h.add(u);const d=new n(u);e.scene.add(d),d.isBinary=null!==(i=t.isBinary)&&void 0!==i&&i,t.binds&&t.binds.forEach((i=>o(this,void 0,void 0,(function*(){if(void 0===i.mesh||void 0===i.index)return;const r=[];this.parser.json.nodes.forEach(((e,t)=>{e.mesh===i.mesh&&r.push(t)}));const n=i.index;yield Promise.all(r.map((r=>o(this,void 0,void 0,(function*(){var o;const s=yield a(e,r);s.every((e=>Array.isArray(e.morphTargetInfluences)&&n<e.morphTargetInfluences.length))?d.addBind(new f({primitives:s,index:n,weight:.01*(null!==(o=i.weight)&&void 0!==o?o:100)})):console.warn(`VRMExpressionLoaderPlugin: ${t.name} attempts to index ${n}th morph but not found.`)})))))}))));const p=t.materialValues;p&&0!==p.length&&console.warn("Material binds of VRM 0.0 are not supported. Setup the model in VRM 1.0 and try again"),s.registerExpression(d)}))))),s}))}}y.v0v1PresetNameMap={a:"aa",e:"ee",i:"ih",o:"oh",u:"ou",blink:"blink",joy:"happy",angry:"angry",sorrow:"sad",fun:"relaxed",lookup:"lookUp",lookdown:"lookDown",lookleft:"lookLeft",lookright:"lookRight",blink_l:"blinkLeft",blink_r:"blinkRight",neutral:"neutral"};class x{constructor(e,t){this._firstPersonOnlyLayer=x.DEFAULT_FIRSTPERSON_ONLY_LAYER,this._thirdPersonOnlyLayer=x.DEFAULT_THIRDPERSON_ONLY_LAYER,this._initializedLayers=!1,this.humanoid=e,this.meshAnnotations=t}copy(e){if(this.humanoid!==e.humanoid)throw new Error("VRMFirstPerson: humanoid must be same in order to copy");return this.meshAnnotations=e.meshAnnotations.map((e=>({meshes:e.meshes.concat(),type:e.type}))),this}clone(){return new x(this.humanoid,this.meshAnnotations).copy(this)}get firstPersonOnlyLayer(){return this._firstPersonOnlyLayer}get thirdPersonOnlyLayer(){return this._thirdPersonOnlyLayer}setup({firstPersonOnlyLayer:e=x.DEFAULT_FIRSTPERSON_ONLY_LAYER,thirdPersonOnlyLayer:t=x.DEFAULT_THIRDPERSON_ONLY_LAYER}={}){this._initializedLayers||(this._firstPersonOnlyLayer=e,this._thirdPersonOnlyLayer=t,this.meshAnnotations.forEach((e=>{e.meshes.forEach((t=>{"firstPersonOnly"===e.type?(t.layers.set(this._firstPersonOnlyLayer),t.traverse((e=>e.layers.set(this._firstPersonOnlyLayer)))):"thirdPersonOnly"===e.type?(t.layers.set(this._thirdPersonOnlyLayer),t.traverse((e=>e.layers.set(this._thirdPersonOnlyLayer)))):"auto"===e.type&&this._createHeadlessModel(t)}))})),this._initializedLayers=!0)}_excludeTriangles(e,t,i,r){let n=0;if(null!=t&&t.length>0)for(let o=0;o<e.length;o+=3){const s=e[o],a=e[o+1],l=e[o+2],h=t[s],u=i[s];if(h[0]>0&&r.includes(u[0]))continue;if(h[1]>0&&r.includes(u[1]))continue;if(h[2]>0&&r.includes(u[2]))continue;if(h[3]>0&&r.includes(u[3]))continue;const d=t[a],p=i[a];if(d[0]>0&&r.includes(p[0]))continue;if(d[1]>0&&r.includes(p[1]))continue;if(d[2]>0&&r.includes(p[2]))continue;if(d[3]>0&&r.includes(p[3]))continue;const c=t[l],m=i[l];c[0]>0&&r.includes(m[0])||(c[1]>0&&r.includes(m[1])||c[2]>0&&r.includes(m[2])||c[3]>0&&r.includes(m[3])||(e[n++]=s,e[n++]=a,e[n++]=l))}return n}_createErasedMesh(e,t){const i=new r.SkinnedMesh(e.geometry.clone(),e.material);i.name=`${e.name}(erase)`,i.frustumCulled=e.frustumCulled,i.layers.set(this._firstPersonOnlyLayer);const n=i.geometry,o=n.getAttribute("skinIndex").array,s=[];for(let e=0;e<o.length;e+=4)s.push([o[e],o[e+1],o[e+2],o[e+3]]);const a=n.getAttribute("skinWeight").array,l=[];for(let e=0;e<a.length;e+=4)l.push([a[e],a[e+1],a[e+2],a[e+3]]);const h=n.getIndex();if(!h)throw new Error("The geometry doesn't have an index buffer");const u=Array.from(h.array),d=this._excludeTriangles(u,l,s,t),p=[];for(let e=0;e<d;e++)p[e]=u[e];return n.setIndex(p),e.onBeforeRender&&(i.onBeforeRender=e.onBeforeRender),i.bind(new r.Skeleton(e.skeleton.bones,e.skeleton.boneInverses),new r.Matrix4),i}_createHeadlessModelForSkinnedMesh(e,t){const i=[];if(t.skeleton.bones.forEach(((e,t)=>{this._isEraseTarget(e)&&i.push(t)})),!i.length)return t.layers.enable(this._thirdPersonOnlyLayer),void t.layers.enable(this._firstPersonOnlyLayer);t.layers.set(this._thirdPersonOnlyLayer);const r=this._createErasedMesh(t,i);e.add(r)}_createHeadlessModel(e){if("Group"===e.type)if(e.layers.set(this._thirdPersonOnlyLayer),this._isEraseTarget(e))e.traverse((e=>e.layers.set(this._thirdPersonOnlyLayer)));else{const t=new r.Group;t.name=`_headless_${e.name}`,t.layers.set(this._firstPersonOnlyLayer),e.parent.add(t),e.children.filter((e=>"SkinnedMesh"===e.type)).forEach((e=>{const i=e;this._createHeadlessModelForSkinnedMesh(t,i)}))}else if("SkinnedMesh"===e.type){const t=e;this._createHeadlessModelForSkinnedMesh(e.parent,t)}else this._isEraseTarget(e)&&(e.layers.set(this._thirdPersonOnlyLayer),e.traverse((e=>e.layers.set(this._thirdPersonOnlyLayer))))}_isEraseTarget(e){return e===this.humanoid.getBoneNode("head")||!!e.parent&&this._isEraseTarget(e.parent)}}x.DEFAULT_FIRSTPERSON_ONLY_LAYER=9,x.DEFAULT_THIRDPERSON_ONLY_LAYER=10;class _{constructor(e){this.parser=e}get name(){return"VRMFirstPersonLoaderPlugin"}afterRoot(e){return o(this,void 0,void 0,(function*(){const t=e.userData.vrmHumanoid;if(null!==t){if(void 0===t)throw new Error("VRMFirstPersonLoaderPlugin: vrmHumanoid is undefined. VRMHumanoidLoaderPlugin have to be used first");e.userData.vrmFirstPerson=yield this._import(e,t)}}))}_import(e,t){return o(this,void 0,void 0,(function*(){if(null==t)return null;const i=yield this._v1Import(e,t);if(i)return i;const r=yield this._v0Import(e,t);return r||null}))}_v1Import(e,t){var i,r;return o(this,void 0,void 0,(function*(){if(!(-1!==(null===(i=this.parser.json.extensionsUsed)||void 0===i?void 0:i.indexOf("VRMC_vrm"))))return null;const n=null===(r=this.parser.json.extensions)||void 0===r?void 0:r.VRMC_vrm;if(!n)return null;if("1.0-beta"!==n.specVersion)return null;const o=n.firstPerson;if(!o)return null;const s=[],a=yield l(e);return Array.from(a.entries()).forEach((([e,t])=>{var i;const r=o.meshAnnotations?o.meshAnnotations.find((t=>t.node===e)):void 0;s.push({meshes:t,type:null!==(i=null==r?void 0:r.type)&&void 0!==i?i:"both"})})),new x(t,s)}))}_v0Import(e,t){var i;return o(this,void 0,void 0,(function*(){const r=null===(i=this.parser.json.extensions)||void 0===i?void 0:i.VRM;if(!r)return null;const n=r.firstPerson;if(!n)return null;const o=[],s=yield l(e);return Array.from(s.entries()).forEach((([e,t])=>{const i=this.parser.json.nodes[e],r=n.meshAnnotations?n.meshAnnotations.find((e=>e.mesh===i.mesh)):void 0;o.push({meshes:t,type:this._convertV0FlagToV1Type(null==r?void 0:r.firstPersonFlag)})})),new x(t,o)}))}_convertV0FlagToV1Type(e){return"FirstPersonOnly"===e?"firstPersonOnly":"ThirdPersonOnly"===e?"thirdPersonOnly":"Auto"===e?"auto":"both"}}function M(e){return e.invert?e.invert():e.inverse(),e}const L=new r.Vector3,R=new r.Quaternion;class w{constructor(e){this.humanBones=e,this.restPose=this.getAbsolutePose()}copy(e){return this.humanBones=e.humanBones,this.restPose=e.restPose,this}clone(){return new w(this.humanBones).copy(this)}getAbsolutePose(){const e={};return Object.keys(this.humanBones).forEach((t=>{const i=t,r=this.getBoneNode(i);r&&(L.copy(r.position),R.copy(r.quaternion),e[i]={position:L.toArray(),rotation:R.toArray()})})),e}getPose(){const e={};return Object.keys(this.humanBones).forEach((t=>{const i=t,r=this.getBoneNode(i);if(!r)return;L.set(0,0,0),R.identity();const n=this.restPose[i];(null==n?void 0:n.position)&&L.fromArray(n.position).negate(),(null==n?void 0:n.rotation)&&M(R.fromArray(n.rotation)),L.add(r.position),R.premultiply(r.quaternion),e[i]={position:L.toArray(),rotation:R.toArray()}})),e}setPose(e){Object.entries(e).forEach((([e,t])=>{const i=e,r=this.getBoneNode(i);if(!r)return;const n=this.restPose[i];n&&((null==t?void 0:t.position)&&(r.position.fromArray(t.position),n.position&&r.position.add(L.fromArray(n.position))),(null==t?void 0:t.rotation)&&(r.quaternion.fromArray(t.rotation),n.rotation&&r.quaternion.multiply(R.fromArray(n.rotation))))}))}resetPose(){Object.entries(this.restPose).forEach((([e,t])=>{const i=this.getBoneNode(e);i&&((null==t?void 0:t.position)&&i.position.fromArray(t.position),(null==t?void 0:t.rotation)&&i.quaternion.fromArray(t.rotation))}))}getBone(e){var t;return null!==(t=this.humanBones[e])&&void 0!==t?t:void 0}getBoneNode(e){var t,i;return null!==(i=null===(t=this.humanBones[e])||void 0===t?void 0:t.node)&&void 0!==i?i:null}}const P={Hips:"hips",Spine:"spine",Head:"head",LeftUpperLeg:"leftUpperLeg",LeftLowerLeg:"leftLowerLeg",LeftFoot:"leftFoot",RightUpperLeg:"rightUpperLeg",RightLowerLeg:"rightLowerLeg",RightFoot:"rightFoot",LeftUpperArm:"leftUpperArm",LeftLowerArm:"leftLowerArm",LeftHand:"leftHand",RightUpperArm:"rightUpperArm",RightLowerArm:"rightLowerArm",RightHand:"rightHand"};class A{constructor(e){this.parser=e}get name(){return"VRMHumanoidLoaderPlugin"}afterRoot(e){return o(this,void 0,void 0,(function*(){e.userData.vrmHumanoid=yield this._import(e)}))}_import(e){return o(this,void 0,void 0,(function*(){const t=yield this._v1Import(e);if(t)return t;const i=yield this._v0Import(e);return i||null}))}_v1Import(e){var t,i;return o(this,void 0,void 0,(function*(){if(!(-1!==(null===(t=this.parser.json.extensionsUsed)||void 0===t?void 0:t.indexOf("VRMC_vrm"))))return null;const e=null===(i=this.parser.json.extensions)||void 0===i?void 0:i.VRMC_vrm;if(!e)return null;if("1.0-beta"!==e.specVersion)return null;const r=e.humanoid;if(!r)return null;const n={};return null!=r.humanBones&&(yield Promise.all(Object.entries(r.humanBones).map((([e,t])=>o(this,void 0,void 0,(function*(){const i=e,r=t.node,o=yield this.parser.getDependency("node",r);null!=o?n[i]={node:o}:console.warn(`A glTF node bound to the humanoid bone ${i} (index = ${r}) does not exist`)})))))),new w(this._ensureRequiredBonesExist(n))}))}_v0Import(e){var t;return o(this,void 0,void 0,(function*(){const e=null===(t=this.parser.json.extensions)||void 0===t?void 0:t.VRM;if(!e)return null;const i=e.humanoid;if(!i)return null;const r={};return null!=i.humanBones&&(yield Promise.all(i.humanBones.map((e=>o(this,void 0,void 0,(function*(){const t=e.bone,i=e.node;if(null==t||null==i)return;const n=yield this.parser.getDependency("node",i);null!=n?null==r[t]?r[t]={node:n}:console.warn(`Multiple bone entries for ${t} detected (index = ${i}), ignoring duplicated entries.`):console.warn(`A glTF node bound to the humanoid bone ${t} (index = ${i}) does not exist`)})))))),new w(this._ensureRequiredBonesExist(r))}))}_ensureRequiredBonesExist(e){const t=Object.values(P).filter((t=>null==e[t]));if(t.length>0)throw new Error(`VRMHumanoidLoaderPlugin: These humanoid bones are required but not exist: ${t.join(", ")}`);return e}}class b extends r.BufferGeometry{constructor(){super(),this._currentTheta=0,this._currentRadius=0,this.theta=0,this.radius=0,this._currentTheta=0,this._currentRadius=0,this._attrPos=new r.BufferAttribute(new Float32Array(195),3),this.setAttribute("position",this._attrPos),this._attrIndex=new r.BufferAttribute(new Uint16Array(189),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;this._currentTheta!==this.theta&&(this._currentTheta=this.theta,e=!0),this._currentRadius!==this.radius&&(this._currentRadius=this.radius,e=!0),e&&this._buildPosition()}_buildPosition(){this._attrPos.setXYZ(0,0,0,0);for(let e=0;e<64;e++){const t=e/63*this._currentTheta;this._attrPos.setXYZ(e+1,this._currentRadius*Math.sin(t),0,this._currentRadius*Math.cos(t))}this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<63;e++)this._attrIndex.setXYZ(3*e,0,e+1,e+2);this._attrIndex.needsUpdate=!0}}class E extends r.BufferGeometry{constructor(){super(),this.radius=0,this._currentRadius=0,this.tail=new r.Vector3,this._currentTail=new r.Vector3,this._attrPos=new r.BufferAttribute(new Float32Array(294),3),this.setAttribute("position",this._attrPos),this._attrIndex=new r.BufferAttribute(new Uint16Array(194),1),this.setIndex(this._attrIndex),this._buildIndex(),this.update()}update(){let e=!1;this._currentRadius!==this.radius&&(this._currentRadius=this.radius,e=!0),this._currentTail.equals(this.tail)||(this._currentTail.copy(this.tail),e=!0),e&&this._buildPosition()}_buildPosition(){for(let e=0;e<32;e++){const t=e/16*Math.PI;this._attrPos.setXYZ(e,Math.cos(t),Math.sin(t),0),this._attrPos.setXYZ(32+e,0,Math.cos(t),Math.sin(t)),this._attrPos.setXYZ(64+e,Math.sin(t),0,Math.cos(t))}this.scale(this._currentRadius,this._currentRadius,this._currentRadius),this.translate(this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.setXYZ(96,0,0,0),this._attrPos.setXYZ(97,this._currentTail.x,this._currentTail.y,this._currentTail.z),this._attrPos.needsUpdate=!0}_buildIndex(){for(let e=0;e<32;e++){const t=(e+1)%32;this._attrIndex.setXY(2*e,e,t),this._attrIndex.setXY(64+2*e,32+e,32+t),this._attrIndex.setXY(128+2*e,64+e,64+t)}this._attrIndex.setXY(192,96,97),this._attrIndex.needsUpdate=!0}}const k=new r.Quaternion,V=new r.Quaternion,I=new r.Vector3,O=new r.Vector3,T=Math.sqrt(2)/2,U=new r.Quaternion(0,0,-T,T),B=new r.Vector3(0,1,0);class D extends r.Group{constructor(e){super(),this.matrixAutoUpdate=!1,this.vrmLookAt=e;{const e=new b;e.radius=.5;const t=new r.MeshBasicMaterial({color:65280,transparent:!0,opacity:.5,side:r.DoubleSide,depthTest:!1,depthWrite:!1});this._meshPitch=new r.Mesh(e,t),this.add(this._meshPitch)}{const e=new b;e.radius=.5;const t=new r.MeshBasicMaterial({color:16711680,transparent:!0,opacity:.5,side:r.DoubleSide,depthTest:!1,depthWrite:!1});this._meshYaw=new r.Mesh(e,t),this.add(this._meshYaw)}{const e=new E;e.radius=.1;const t=new r.LineBasicMaterial({color:16777215,depthTest:!1,depthWrite:!1});this._lineTarget=new r.LineSegments(e,t),this._lineTarget.frustumCulled=!1,this.add(this._lineTarget)}}dispose(){this._meshYaw.geometry.dispose(),this._meshYaw.material.dispose(),this._meshPitch.geometry.dispose(),this._meshPitch.material.dispose(),this._lineTarget.geometry.dispose(),this._lineTarget.material.dispose()}updateMatrixWorld(e){this.vrmLookAt.getLookAtWorldPosition(I),this.vrmLookAt.getLookAtWorldQuaternion(k);const t=this.vrmLookAt.euler.y,i=this.vrmLookAt.euler.x;this._meshYaw.geometry.theta=t,this._meshYaw.geometry.update(),this._meshYaw.position.copy(I),this._meshYaw.quaternion.copy(k),this._meshPitch.geometry.theta=i,this._meshPitch.geometry.update(),this._meshPitch.position.copy(I),this._meshPitch.quaternion.copy(k),this._meshPitch.quaternion.multiply(V.setFromAxisAngle(B,t)),this._meshPitch.quaternion.multiply(U);const r=this.vrmLookAt.target;null!=r&&(r.getWorldPosition(O).sub(I),this._lineTarget.geometry.tail.copy(O),this._lineTarget.geometry.update(),this._lineTarget.position.copy(I)),super.updateMatrixWorld(e)}}const N=new r.Vector3,F=new r.Vector3;const H=new r.Vector3,S=new r.Vector3,j=new r.Vector3,C=new r.Quaternion,Y=new r.Quaternion;class W{constructor(e,t){this.offsetFromHeadBone=new r.Vector3,this.autoUpdate=!0,this.faceFront=new r.Vector3(0,0,1),this._euler=new r.Euler(0,0,0,W.EULER_ORDER),this.humanoid=e,this.applier=t}get euler(){return this._euler.clone()}copy(e){if(this.humanoid!==e.humanoid)throw new Error("VRMLookAt: humanoid must be same in order to copy");return this.offsetFromHeadBone.copy(e.offsetFromHeadBone),this.applier=e.applier,this.autoUpdate=e.autoUpdate,this.target=e.target,this.faceFront.copy(e.faceFront),this}clone(){return new W(this.humanoid,this.applier).copy(this)}reset(){this._euler.set(0,0,0),this.applier.lookAt(this._euler)}getLookAtWorldPosition(e){const t=this.humanoid.getBoneNode("head");return e.copy(this.offsetFromHeadBone).applyMatrix4(t.matrixWorld)}getLookAtWorldQuaternion(e){const t=this.humanoid.getBoneNode("head");return i=e,t.matrixWorld.decompose(N,i,F),i;var i}getLookAtWorldDirection(e){return this.getLookAtWorldQuaternion(C),e.copy(this.faceFront).applyEuler(this._euler).applyQuaternion(C)}lookAt(e){this._calcEuler(this._euler,e),this.applier.lookAt(this._euler)}update(e){this.target&&this.autoUpdate&&(this.lookAt(this.target.getWorldPosition(H)),this.applier.lookAt(this._euler))}_calcEuler(e,t){const i=M(this.getLookAtWorldQuaternion(C)),r=this.getLookAtWorldPosition(S),n=j.copy(t).sub(r).applyQuaternion(i).normalize(),o=Y.setFromUnitVectors(this.faceFront,n);return j.set(0,0,1).applyQuaternion(o),e.x=Math.atan2(-j.y,Math.sqrt(j.x*j.x+j.z*j.z)),e.y=Math.atan2(j.x,j.z),e}}W.EULER_ORDER="YXZ";const $=new r.Euler(0,0,0,"YXZ");class z{constructor(e,t,i,r,n){this.humanoid=e,this.rangeMapHorizontalInner=t,this.rangeMapHorizontalOuter=i,this.rangeMapVerticalDown=r,this.rangeMapVerticalUp=n}lookAt(e){const t=180*e.x/Math.PI,i=180*e.y/Math.PI,r=this.humanoid.getBoneNode("leftEye"),n=this.humanoid.getBoneNode("rightEye");r&&($.x=t<0?-this.rangeMapVerticalDown.map(-t)/180*Math.PI:this.rangeMapVerticalUp.map(t)/180*Math.PI,$.y=i<0?-this.rangeMapHorizontalInner.map(-i)/180*Math.PI:this.rangeMapHorizontalOuter.map(i)/180*Math.PI,r.quaternion.setFromEuler($)),n&&($.x=t<0?-this.rangeMapVerticalDown.map(-t)/180*Math.PI:this.rangeMapVerticalUp.map(t)/180*Math.PI,$.y=i<0?-this.rangeMapHorizontalOuter.map(-i)/180*Math.PI:this.rangeMapHorizontalInner.map(i)/180*Math.PI,n.quaternion.setFromEuler($))}}z.type="bone";class q{constructor(e,t,i,r,n){this.expressions=e,this.rangeMapHorizontalInner=t,this.rangeMapHorizontalOuter=i,this.rangeMapVerticalDown=r,this.rangeMapVerticalUp=n}lookAt(e){const t=180*e.x/Math.PI,i=180*e.y/Math.PI;t<0?(this.expressions.setValue("lookDown",0),this.expressions.setValue("lookUp",this.rangeMapVerticalUp.map(-t))):(this.expressions.setValue("lookUp",0),this.expressions.setValue("lookDown",this.rangeMapVerticalDown.map(t))),i<0?(this.expressions.setValue("lookLeft",0),this.expressions.setValue("lookRight",this.rangeMapHorizontalOuter.map(-i))):(this.expressions.setValue("lookRight",0),this.expressions.setValue("lookLeft",this.rangeMapHorizontalOuter.map(i)))}}q.type="expression";class X{constructor(e,t){this.inputMaxValue=e,this.outputScale=t}map(e){return this.outputScale*d(e/this.inputMaxValue)}}class Q{constructor(e,t){this.parser=e,this.helperRoot=null==t?void 0:t.helperRoot}get name(){return"VRMLookAtLoaderPlugin"}afterRoot(e){return o(this,void 0,void 0,(function*(){const t=e.userData.vrmHumanoid;if(null===t)return;if(void 0===t)throw new Error("VRMFirstPersonLoaderPlugin: vrmHumanoid is undefined. VRMHumanoidLoaderPlugin have to be used first");const i=e.userData.vrmExpressionManager;if(null!==i){if(void 0===i)throw new Error("VRMFirstPersonLoaderPlugin: vrmExpressionManager is undefined. VRMExpressionLoaderPlugin have to be used first");e.userData.vrmLookAt=yield this._import(e,t,i)}}))}_import(e,t,i){return o(this,void 0,void 0,(function*(){if(null==t||null==i)return null;const r=yield this._v1Import(e,t,i);if(r)return r;const n=yield this._v0Import(e,t,i);return n||null}))}_v1Import(e,t,i){var r,n,s;return o(this,void 0,void 0,(function*(){if(!(-1!==(null===(r=this.parser.json.extensionsUsed)||void 0===r?void 0:r.indexOf("VRMC_vrm"))))return null;const e=null===(n=this.parser.json.extensions)||void 0===n?void 0:n.VRMC_vrm;if(!e)return null;if("1.0-beta"!==e.specVersion)return null;const o=e.lookAt;if(!o)return null;const a="expression"===o.type?1:10,l=this._v1ImportRangeMap(o.rangeMapHorizontalInner,a),h=this._v1ImportRangeMap(o.rangeMapHorizontalOuter,a),u=this._v1ImportRangeMap(o.rangeMapVerticalDown,a),d=this._v1ImportRangeMap(o.rangeMapVerticalUp,a);let p;p="expression"===o.type?new q(i,l,h,u,d):new z(t,l,h,u,d);const c=this._importLookAt(t,p);return c.offsetFromHeadBone.fromArray(null!==(s=o.offsetFromHeadBone)&&void 0!==s?s:[0,.06,0]),c}))}_v1ImportRangeMap(e,t){var i,r;return new X(null!==(i=null==e?void 0:e.inputMaxValue)&&void 0!==i?i:90,null!==(r=null==e?void 0:e.outputScale)&&void 0!==r?r:t)}_v0Import(e,t,i){var r,n,s,a;return o(this,void 0,void 0,(function*(){const e=null===(r=this.parser.json.extensions)||void 0===r?void 0:r.VRM;if(!e)return null;const o=e.firstPerson;if(!o)return null;const l="BlendShape"===o.lookAtTypeName?1:10,h=this._v0ImportDegreeMap(o.lookAtHorizontalInner,l),u=this._v0ImportDegreeMap(o.lookAtHorizontalOuter,l),d=this._v0ImportDegreeMap(o.lookAtVerticalDown,l),p=this._v0ImportDegreeMap(o.lookAtVerticalUp,l);let c;c="BlendShape"===o.lookAtTypeName?new q(i,h,u,d,p):new z(t,h,u,d,p);const m=this._importLookAt(t,c);return o.firstPersonBoneOffset?m.offsetFromHeadBone.set(null!==(n=o.firstPersonBoneOffset.x)&&void 0!==n?n:0,null!==(s=o.firstPersonBoneOffset.y)&&void 0!==s?s:.06,-(null!==(a=o.firstPersonBoneOffset.z)&&void 0!==a?a:0)):m.offsetFromHeadBone.set(0,.06,0),m.faceFront.set(0,0,-1),m}))}_v0ImportDegreeMap(e,t){var i,r;const n=null==e?void 0:e.curve;return"[0,0,0,1,1,1,1,0]"!==JSON.stringify(n)&&console.warn("Curves of LookAtDegreeMap defined in VRM 0.0 are not supported"),new X(null!==(i=null==e?void 0:e.xRange)&&void 0!==i?i:90,null!==(r=null==e?void 0:e.yRange)&&void 0!==r?r:t)}_importLookAt(e,t){const i=new W(e,t);if(this.helperRoot){const e=new D(i);this.helperRoot.add(e),e.renderOrder=this.helperRoot.renderOrder}return i}}class Z{constructor(e,t){var i,r,n;this.parser=e,this.needThumbnailImage=null===(i=null==t?void 0:t.needThumbnailImage)||void 0===i||i,this.acceptLicenseUrls=null!==(r=null==t?void 0:t.acceptLicenseUrls)&&void 0!==r?r:["https://vrm.dev/licenses/1.0/"],this.acceptV0Meta=null===(n=null==t?void 0:t.acceptV0Meta)||void 0===n||n}get name(){return"VRMMetaLoaderPlugin"}afterRoot(e){return o(this,void 0,void 0,(function*(){e.userData.vrmMeta=yield this._import(e)}))}_import(e){return o(this,void 0,void 0,(function*(){const t=yield this._v1Import(e);if(null!=t)return t;const i=yield this._v0Import(e);return null!=i?i:null}))}_v1Import(e){var t,i,r;return o(this,void 0,void 0,(function*(){if(!(-1!==(null===(t=this.parser.json.extensionsUsed)||void 0===t?void 0:t.indexOf("VRMC_vrm"))))return null;const e=null===(i=this.parser.json.extensions)||void 0===i?void 0:i.VRMC_vrm;if(null==e)return null;if("1.0-beta"!==e.specVersion)return null;const n=e.meta;if(!n)return null;const o=n.licenseUrl;if(!new Set(this.acceptLicenseUrls).has(o))throw new Error(`VRMMetaLoaderPlugin: The license url "${o}" is not accepted`);let s;return this.needThumbnailImage&&null!=n.thumbnailImage&&(s=null!==(r=yield this._extractGLTFImage(n.thumbnailImage))&&void 0!==r?r:void 0),{metaVersion:"1",name:n.name,version:n.version,authors:n.authors,copyrightInformation:n.copyrightInformation,contactInformation:n.contactInformation,references:n.references,thirdPartyLicenses:n.thirdPartyLicenses,thumbnailImage:s,licenseUrl:n.licenseUrl,avatarPermission:n.avatarPermission,allowExcessivelyViolentUsage:n.allowExcessivelyViolentUsage,allowExcessivelySexualUsage:n.allowExcessivelySexualUsage,commercialUsage:n.commercialUsage,allowPoliticalOrReligiousUsage:n.allowPoliticalOrReligiousUsage,allowAntisocialOrHateUsage:n.allowAntisocialOrHateUsage,creditNotation:n.creditNotation,allowRedistribution:n.allowRedistribution,modification:n.modification,otherLicenseUrl:n.otherLicenseUrl}}))}_v0Import(e){var t;return o(this,void 0,void 0,(function*(){const e=null===(t=this.parser.json.extensions)||void 0===t?void 0:t.VRM;if(!e)return null;const i=e.meta;if(!i)return null;if(!this.acceptV0Meta)throw new Error("VRMMetaLoaderPlugin: Attempted to load VRM0.X meta but acceptV0Meta is false");let r;return this.needThumbnailImage&&null!=i.texture&&-1!==i.texture&&(r=yield this.parser.getDependency("texture",i.texture)),{metaVersion:"0",allowedUserName:i.allowedUserName,author:i.author,commercialUssageName:i.commercialUssageName,contactInformation:i.contactInformation,licenseName:i.licenseName,otherLicenseUrl:i.otherLicenseUrl,otherPermissionUrl:i.otherPermissionUrl,reference:i.reference,sexualUssageName:i.sexualUssageName,texture:null!=r?r:void 0,title:i.title,version:i.version,violentUssageName:i.violentUssageName}}))}_extractGLTFImage(e){var t;return o(this,void 0,void 0,(function*(){const i=null===(t=this.parser.json.images)||void 0===t?void 0:t[e];if(null==i)return console.warn(`Attempt to use images[${e}] of glTF as a thumbnail but the image doesn't exist`),null;let n=i.uri;if(null!=i.bufferView){const e=yield this.parser.getDependency("bufferView",i.bufferView),t=new Blob([e],{type:i.mimeType});n=URL.createObjectURL(t)}if(null==n)return console.warn(`Attempt to use images[${e}] of glTF as a thumbnail but the image couldn't load properly`),null;const o=new r.ImageLoader;return yield o.loadAsync((s=n,a=this.parser.options.path,"string"!=typeof s||""===s?"":(/^https?:\/\//i.test(a)&&/^\//.test(s)&&(a=a.replace(/(^https?:\/\/[^/]+).*/i,"$1")),/^(https?:)?\/\//i.test(s)||/^data:.*,.*$/i.test(s)||/^blob:.*$/i.test(s)?s:a+s))).catch((e=>(console.error(e),console.warn("Failed to load a thumbnail image"),null)));var s,a}))}}class G{constructor(e){this.scene=e.scene,this.humanoid=e.humanoid,this.expressionManager=e.expressionManager,this.firstPerson=e.firstPerson,this.lookAt=e.lookAt,this.meta=e.meta}update(e){this.lookAt&&this.lookAt.update(e),this.expressionManager&&this.expressionManager.update()}}e.VRMCore=G,e.VRMCoreLoaderPlugin=class{constructor(e,t){var i,r,n,o,s;this.parser=e;const a=null==t?void 0:t.helperRoot;this.expressionPlugin=null!==(i=null==t?void 0:t.expressionPlugin)&&void 0!==i?i:new y(e),this.firstPersonPlugin=null!==(r=null==t?void 0:t.firstPersonPlugin)&&void 0!==r?r:new _(e),this.humanoidPlugin=null!==(n=null==t?void 0:t.humanoidPlugin)&&void 0!==n?n:new A(e),this.lookAtPlugin=null!==(o=null==t?void 0:t.lookAtPlugin)&&void 0!==o?o:new Q(e,{helperRoot:a}),this.metaPlugin=null!==(s=null==t?void 0:t.metaPlugin)&&void 0!==s?s:new Z(e)}get name(){return"VRMC_vrm"}afterRoot(e){return o(this,void 0,void 0,(function*(){yield this.metaPlugin.afterRoot(e),yield this.humanoidPlugin.afterRoot(e),yield this.expressionPlugin.afterRoot(e),yield this.lookAtPlugin.afterRoot(e),yield this.firstPersonPlugin.afterRoot(e);const t=new G({scene:e.scene,expressionManager:e.userData.vrmExpressionManager,firstPerson:e.userData.vrmFirstPerson,humanoid:e.userData.vrmHumanoid,lookAt:e.userData.vrmLookAt,meta:e.userData.vrmMeta});e.userData.vrmCore=t}))}},e.VRMExpression=n,e.VRMExpressionLoaderPlugin=y,e.VRMExpressionManager=p,e.VRMExpressionMaterialColorType={Color:"color",EmissionColor:"emissionColor",ShadeColor:"shadeColor",RimColor:"rimColor",OutlineColor:"outlineColor"},e.VRMExpressionOverrideType={None:"none",Block:"block",Blend:"blend"},e.VRMExpressionPresetName=u,e.VRMFirstPerson=x,e.VRMFirstPersonLoaderPlugin=_,e.VRMFirstPersonMeshAnnotationType={Auto:"auto",Both:"both",ThirdPersonOnly:"thirdPersonOnly",FirstPersonOnly:"firstPersonOnly"},e.VRMHumanBoneName={Hips:"hips",Spine:"spine",Chest:"chest",UpperChest:"upperChest",Neck:"neck",Head:"head",LeftEye:"leftEye",RightEye:"rightEye",Jaw:"jaw",LeftUpperLeg:"leftUpperLeg",LeftLowerLeg:"leftLowerLeg",LeftFoot:"leftFoot",LeftToes:"leftToes",RightUpperLeg:"rightUpperLeg",RightLowerLeg:"rightLowerLeg",RightFoot:"rightFoot",RightToes:"rightToes",LeftShoulder:"leftShoulder",LeftUpperArm:"leftUpperArm",LeftLowerArm:"leftLowerArm",LeftHand:"leftHand",RightShoulder:"rightShoulder",RightUpperArm:"rightUpperArm",RightLowerArm:"rightLowerArm",RightHand:"rightHand",LeftThumbProximal:"leftThumbProximal",LeftThumbIntermediate:"leftThumbIntermediate",LeftThumbDistal:"leftThumbDistal",LeftIndexProximal:"leftIndexProximal",LeftIndexIntermediate:"leftIndexIntermediate",LeftIndexDistal:"leftIndexDistal",LeftMiddleProximal:"leftMiddleProximal",LeftMiddleIntermediate:"leftMiddleIntermediate",LeftMiddleDistal:"leftMiddleDistal",LeftRingProximal:"leftRingProximal",LeftRingIntermediate:"leftRingIntermediate",LeftRingDistal:"leftRingDistal",LeftLittleProximal:"leftLittleProximal",LeftLittleIntermediate:"leftLittleIntermediate",LeftLittleDistal:"leftLittleDistal",RightThumbProximal:"rightThumbProximal",RightThumbIntermediate:"rightThumbIntermediate",RightThumbDistal:"rightThumbDistal",RightIndexProximal:"rightIndexProximal",RightIndexIntermediate:"rightIndexIntermediate",RightIndexDistal:"rightIndexDistal",RightMiddleProximal:"rightMiddleProximal",RightMiddleIntermediate:"rightMiddleIntermediate",RightMiddleDistal:"rightMiddleDistal",RightRingProximal:"rightRingProximal",RightRingIntermediate:"rightRingIntermediate",RightRingDistal:"rightRingDistal",RightLittleProximal:"rightLittleProximal",RightLittleIntermediate:"rightLittleIntermediate",RightLittleDistal:"rightLittleDistal"},e.VRMHumanoid=w,e.VRMHumanoidLoaderPlugin=A,e.VRMLookAt=W,e.VRMLookAtBoneApplier=z,e.VRMLookAtExpressionApplier=q,e.VRMLookAtHelper=D,e.VRMLookAtLoaderPlugin=Q,e.VRMLookAtRangeMap=X,e.VRMLookAtTypeName={Bone:"bone",Expression:"expression"},e.VRMMetaLoaderPlugin=Z,e.VRMRequiredHumanBoneName=P,Object.defineProperty(e,"__esModule",{value:!0}),Object.assign(t,e)}));
